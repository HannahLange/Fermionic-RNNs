1.13.1+cu117
GPU is available
Namespace(Jp=1.0, Jz=1.0, U=1.0, t=8.0, density=0.95, Nx=20, Ny=1, kx=0.5, ky=0.0, bounds=1, boundsx=0, boundsy=1, load_model=1, sym=0.0, antisym=0.0, hd=70)
20 1 0.95 19
20x1_qubits/periodic_open/Jp=1.0Jz=1.0t=8.0den=0.95/
Use RNN cell with weight sharing.
Model parameters: 
rnn.W1: 58800
rnn.b1: 70
rnn.W2: 58800
rnn.b2: 70
rnn.Wmerge: 9800
lin1.weight: 210
lin1.bias: 3
lin2.weight: 210
lin2.bias: 3
Total number of parameters in the network: 127966
check if ../20x1_qubits/periodic_open/Jp=1.0Jz=1.0t=8.0den=0.95/model_params_h=70_no_antisym.pt exists.
load ../20x1_qubits/periodic_open/Jp=1.0Jz=1.0t=8.0den=0.95/model_params_h=70_no_antisym.pt
0.0774777800073995
0.0
tensor(1.2232e-06, device='cuda:0', dtype=torch.float64,
       grad_fn=<MulBackward0>)
--- Start the countdown ---
Epoch: 1/ 10000/ t/epoch=1.22............. Loss: inf, mean(E): -23.39541691+0.00301208j, var(E): 1.83623770, Px: 0.49602664-0.01204000j, Py: 0.00000000+0.00000000j
Traceback (most recent call last):
  File "/ssd003/home/hlange/RNN-VMC/one_hole/tXXZchain/momentum_calculations/run.py", line 107, in <module>
    batch_samples = model.sample(batchsize)
  File "/ssd003/home/hlange/RNN-VMC/one_hole/tXXZchain/momentum_calculations/model.py", line 298, in sample
    samples[nx][ny], sigma, hidden, num_up, num_dn, num_sites = self._gen_samples(nx, ny, direction, inputs, hidden_inputs, samples, num_samples, num, num_up, num_dn, num_sites)
  File "/ssd003/home/hlange/RNN-VMC/one_hole/tXXZchain/momentum_calculations/model.py", line 258, in _gen_samples
    sample = torch.multinomial(ampl, 1) 
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
